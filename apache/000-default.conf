<VirtualHost *:80>
    ServerName altaqastrategy.com
    ServerAlias www.altaqastrategy.com

    # Dossier où se trouve ton build frontend
    DocumentRoot /app/dist

    <Directory /app/dist>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # Enable CORS
    Header set Access-Control-Allow-Origin "*"

    # Handle static files
    <FilesMatch "\.(xml|txt|html|js|css|png|jpg|jpeg|gif|ico|svg)$">
        Require all granted
    </FilesMatch>

    # Proxy les requêtes API vers le backend Node.js
    ProxyPreserveHost On
    ProxyPass /api http://localhost:5050/api    
    ProxyPassReverse /api http://localhost:5050/api

    # Redirige toutes les autres requêtes vers index.html (pour les SPA)
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ /index.html [L]

    ErrorLog /var/log/apache2/error.log
    CustomLog /var/log/apache2/access.log combined
</VirtualHost>