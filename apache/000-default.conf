<VirtualHost *:80>
    ServerName altaqastrategy.com
    ServerAlias www.altaqastrategy.com

    # Dossier où se trouve ton build frontend
    DocumentRoot /app/dist

    <Directory /app/dist>
        Options FollowSymLinks
        AllowOverride All
        Require all granted
        DirectoryIndex index.html
        
        # Disable directory listing
        Options -Indexes
    </Directory>
    
    # Enable CORS
    Header set Access-Control-Allow-Origin "*"

    # Handle static files
    <FilesMatch "\.(xml|txt|html|js|css|png|jpg|jpeg|gif|ico|svg)$">
        Require all granted
    </FilesMatch>

    # Proxy les requêtes API vers le backend Node.js
    ProxyPreserveHost On
    ProxyPass /api http://localhost:5050/api    
    ProxyPassReverse /api http://localhost:5050/api

    # SPA Rewrite Rules
    RewriteEngine On
    
    # If the request is not for a real file or directory
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Rewrite all requests to the front controller
    RewriteRule ^ /index.html [L]

    ErrorLog /var/log/apache2/error.log
    CustomLog /var/log/apache2/access.log combined
</VirtualHost>